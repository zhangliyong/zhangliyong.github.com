<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Lyon's Blog</title>
	<meta name="description" content="">
	<meta name="author" content="zhang liyong">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="../theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="../theme/bootstrap.min.css" rel="stylesheet">
	<link href="../theme/local.css" rel="stylesheet">
	<link href="../theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
        
		</head>
<body>
			<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="../">Lyon's Blog</a>
			<ul class="nav">
																			<li><a href="../pages/about.html">About</a></li>
																		<li ><a href="../category/algorithm.html">algorithm</a></li>
									<li ><a href="../category/bash.html">bash</a></li>
									<li ><a href="../category/db.html">db</a></li>
									<li ><a href="../category/emacs.html">emacs</a></li>
									<li ><a href="../category/git.html">git</a></li>
									<li ><a href="../category/linux.html">linux</a></li>
									<li ><a href="../category/misc.html">misc</a></li>
									<li ><a href="../category/mongo.html">mongo</a></li>
									<li ><a href="../category/munin.html">munin</a></li>
									<li ><a href="../category/mysql.html">mysql</a></li>
									<li ><a href="../category/network.html">network</a></li>
									<li ><a href="../category/nginx.html">nginx</a></li>
									<li ><a href="../category/python.html">python</a></li>
									<li ><a href="../category/vim.html">vim</a></li>
							</ul>
			<p class="pull-right"><a href="../archives.html">[archives]</a> <a href="../tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
								<li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
								<li><a href="http://python.org">Python.org</a></li>
								<li><a href="http://jinja.pocoo.org">Jinja2</a></li>
								<li><a href="#">You can modify those links in your config file</a></li>
							</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
								<li><a href="#">You can add links in your config file</a></li>
								<li><a href="#">Another social link</a></li>
							</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
			<div class="page-header"><h1>Lyon's Blog <small>zhang liyong</small></h1></div>			
<div class='article'>
	<h2>misc</h2>
	<div class="well small">Permalink: <a class="more" href="../misc.html">2013-03-31 20:31:38</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/misc.html">misc</a>
</div>
	<div class="summary"><h1>Mac sshfs</h1>
<p>Mac 挂载远程目录</p>
<p>http://osxfuse.github.com/</p>
<p>install OXSFUSE and SSHFS</p>
<h2>TF-IDF</h2>
<p>http://www.ruanyifeng.com/blog/2013/03/tf-idf.html
http://www.ruanyifeng.com/blog/2013/03/cosine_similarity.html
http://www.ruanyifeng.com/blog/2013/03/automatic_summarization.html</p> <a class="btn primary xsmall" href="../misc.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Mongo</h2>
	<div class="well small">Permalink: <a class="more" href="../mongo.html">2013-07-24 17:36:09</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/mongo.html">mongo</a>
</div>
	<div class="summary"><h2>query after update slow</h2>
<p>这两天有一个接口的速度非常慢，主要是执行一条查询语句非常慢，有时耗时达200秒，于是找到了这条查询语句单独在mongo shell中执行，在mongo shell中执行并不慢，慢慢调试后最终找到问题，原因是在查询语句执行之前执行了两次更新语句。</p>
<p>利用pymongo执行更新时，如果不设置safe=True，mongo会及时返回函数调用，但更新并没有真正执行完，mongo进程在后台继续执行，所以当接着执行查询时，此时更新没有结束，数据库会处于lock状态，查询等待数据库解锁，所以查询非常慢。</p>
<p>把更新语句去除后，查询恢复正常。</p>
<h2>Concurrency</h2>
<p>MongoDB global lock to ga</p>
<h2>Tips</h2>
<h3>If Write Heavy</h3>
<p>Global Lock is Global
As you probably know, MongoDB has a global lock. The ...</p> <a class="btn primary xsmall" href="../mongo.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Mongo Performance</h2>
	<div class="well small">Permalink: <a class="more" href="../mongo-performance.html">2013-07-25 10:07:12</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/mongo.html">mongo</a>
</div>
	<div class="summary"><p>最近mongo的性能</p> <a class="btn primary xsmall" href="../mongo-performance.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Mongodb NUMA 导致的性能问题</h2>
	<div class="well small">Permalink: <a class="more" href="../mongodb-numa-dao-zhi-de-xing-neng-wen-ti.html">2013-05-08 13:45:46</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/mongo.html">mongo</a>
</div>
	<div class="summary"><p>最近升级了mongodb，用mongo连接mongod后出现如下warning:</p>
<div class="highlight"><pre><span class="n">Server</span> <span class="n">has</span> <span class="n">startup</span> <span class="n">warnings</span><span class="o">:</span>
<span class="n">Mon</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">14</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">23</span> <span class="p">[</span><span class="n">initandlisten</span><span class="p">]</span>
<span class="n">Mon</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">14</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">23</span> <span class="p">[</span><span class="n">initandlisten</span><span class="p">]</span> <span class="o">**</span> <span class="n">WARNING</span><span class="o">:</span> <span class="n">You</span> <span class="n">are</span> <span class="n">running</span> <span class="n">on</span> <span class="n">a</span> <span class="n">NUMA</span> <span class="n">machine</span><span class="p">.</span>
<span class="n">Mon</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">14</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mi">23</span> <span class="p">[</span><span class="n">initandlisten</span><span class="p">]</span> <span class="o">**</span>          <span class="n">We</span> <span class="n">suggest</span> <span class="n">launching</span> <span class="n">mongod</span> <span class="n">like</span> <span class="n">this</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">performance</span> <span class="n">problems</span><span class="o">:</span>
<span class="n">Mon</span> <span class="n">Oct</span> <span class="mi">29</span> <span class="mi">14</span><span class="o">:</span><span class="mi">45 ...</span></pre></div> <a class="btn primary xsmall" href="../mongodb-numa-dao-zhi-de-xing-neng-wen-ti.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>munin</h2>
	<div class="well small">Permalink: <a class="more" href="../munin.html">2013-08-05 13:17:46</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/munin.html">munin</a>
</div>
	<div class="summary"><h2>Writing plugins</h2>
<p>global attribute: http://munin-monitoring.org/wiki/protocol-config</p>
<p>redis munin 有改动，总是说Redis找不到，一会儿一下问题，做一个patch</p>
<p>mulitgraph: http://munin-monitoring.org/wiki/protocol-multigraph</p>
<h2>fw_conntract fw_forwarded_local timeout</h2>
<p>配置好munin之后，fw_conntrack总是报警，读不到数据，主要原因是执行fw_conntrack超时，munin plugin的默认超时时间是10s，超时主要是因为<code>cat /proc/net/ip_conntrack</code>，对于网络请求少的服务器，此语句会很快执行完，但对于网络请求比较多的服务器，此语句耗时可能要超过30s。</p>
<p>Google的相应问题，此问题早已被人解决，解决方案见如下链接：
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug ...</p> <a class="btn primary xsmall" href="../munin.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Mysql 性能调优</h2>
	<div class="well small">Permalink: <a class="more" href="../mysql-xing-neng-diao-you.html">2013-05-04 16:35:42</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/mysql.html">mysql</a>
</div>
	<div class="summary"><h2>thread cache size</h2>
<p>http://www.dbasquare.com/kb/mysql-and-thread-cache-size/</p>
<p>query_cache_type可以设置为0(OFF)，1(ON)或者2(DEMOND)，分别表示完全不使用query cache，除显式要求不使用query cache（使用sql_no_cache）之外的所有的select都使用query cache，只有显示要求才使用query cache（使用sql_cache)</p>
<p>show global status like '';
show global variables like '';</p>
<p>innodb_file_per_table</p>
<p>mysql io 延时计算</p>
<h2>mysql backup</h2>
<p>相较前几种方法，备份数据文件最为直接、快速、方便，缺点是基本上不能实现增量备份。为了保证数据的一致性，需要在靠背文件前，执行以下 SQL 语句：</p>
<p>FLUSH ...</p> <a class="btn primary xsmall" href="../mysql-xing-neng-diao-you.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>nginx tips</h2>
	<div class="well small">Permalink: <a class="more" href="../nginx-tips.html">2013-05-13 16:11:31</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/nginx.html">nginx</a>
</div>
	<div class="summary"><h2>nginx backlog</h2>
<h2>Root Directory</h2>
<p>nginx 默认根目录，</p>
<p>如果在配置文件中指定了root，则根目录即为root指定的目录</p>
<p>如果通过编译安装的nginx，则根目录为编译时指定的prefix目录</p>
<p>如果通过包管理器安装，则根目录与发行版相关。例如ubuntu版本的根目录为：
/usr/share/nginx/www</p>
<h2>Custome error page</h2>
<p>nginx 有个默认的错误显示页面</p>
<h2>Ref</h2>
<p>http://wiki.nginx.org/Pitfalls</p> <a class="btn primary xsmall" href="../nginx-tips.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>pelican</h2>
	<div class="well small">Permalink: <a class="more" href="../pelican.html">2013-05-09 10:29:55</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/python.html">python</a>
</div>
	<div class="summary"><h2>介绍</h2>
<p>peclian 是一个python版本的表态页面生成器，类似于jekyll</p> <a class="btn primary xsmall" href="../pelican.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Problems I encouter with emacs</h2>
	<div class="well small">Permalink: <a class="more" href="../problems-i-encouter-with-emacs.html">2013-08-20 18:06:34</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/emacs.html">emacs</a>
</div>
	<div class="summary"><p>emacs with zsh</p>
<p>when I first open zsh in emacs using:</p>
<div class="highlight"><pre><span class="n">M</span><span class="o">-</span><span class="n">x</span> <span class="n">term</span>
</pre></div>


<p>It always print strange characters like "4m", that's because I don't have eterm-color terminfo,
I solve this problem by running:</p>
<div class="highlight"><pre><span class="cp"># If you use Cocoa Emacs or Carbon Emacs</span>
<span class="n">tic</span> <span class="o">-</span><span class="n">o</span> <span class="o">~/</span><span class="p">.</span><span class="n">terminfo</span> <span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Emacs</span><span class="p">.</span><span class="n">app ...</span></pre></div> <a class="btn primary xsmall" href="../problems-i-encouter-with-emacs.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>PuDB</h2>
	<div class="well small">Permalink: <a class="more" href="../pudb.html">2013-08-06 10:31:12</a>
by <a class="url fn" href="../author/zhang-liyong.html">zhang liyong </a>
 in <a href="../category/python.html">python</a>
</div>
	<div class="summary"><p>https://pypi.python.org/pypi/pudb</p> <a class="btn primary xsmall" href="../pudb.html">more…</a>
	</div>
</div>	

<div class="pagination">
<ul>
					<li class="prev"><a href="../author/zhang-liyong2.html">&larr; Previous</a></li>
				<li class=""><a href="../author/zhang-liyong.html">1</a></li>
			<li class=""><a href="../author/zhang-liyong2.html">2</a></li>
			<li class="active"><a href="../author/zhang-liyong3.html">3</a></li>
			<li class=""><a href="../author/zhang-liyong4.html">4</a></li>
			<li class=""><a href="../author/zhang-liyong5.html">5</a></li>
				<li class="next"><a href="../author/zhang-liyong4.html">Next &rarr;</a></li>
	</ul>
</div>

		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; zhang liyong</p>
		</footer>
	  </div>

	</div>
</body>
</html>