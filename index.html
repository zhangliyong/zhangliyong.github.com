<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Lyon's Blog</title>
	<meta name="description" content="">
	<meta name="author" content="zhang liyong">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="./theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="./theme/bootstrap.min.css" rel="stylesheet">
	<link href="./theme/local.css" rel="stylesheet">
	<link href="./theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
        
		</head>
<body>
			<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="./">Lyon's Blog</a>
			<ul class="nav">
																			<li><a href="./pages/about.html">About</a></li>
																		<li ><a href="./category/algorithm.html">algorithm</a></li>
									<li ><a href="./category/bash.html">bash</a></li>
									<li ><a href="./category/db.html">db</a></li>
									<li ><a href="./category/emacs.html">emacs</a></li>
									<li ><a href="./category/git.html">git</a></li>
									<li ><a href="./category/linux.html">linux</a></li>
									<li ><a href="./category/misc.html">misc</a></li>
									<li ><a href="./category/mongo.html">mongo</a></li>
									<li ><a href="./category/munin.html">munin</a></li>
									<li ><a href="./category/mysql.html">mysql</a></li>
									<li ><a href="./category/network.html">network</a></li>
									<li ><a href="./category/nginx.html">nginx</a></li>
									<li ><a href="./category/python.html">python</a></li>
									<li ><a href="./category/vim.html">vim</a></li>
							</ul>
			<p class="pull-right"><a href="./archives.html">[archives]</a> <a href="./tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
								<li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
								<li><a href="http://python.org">Python.org</a></li>
								<li><a href="http://jinja.pocoo.org">Jinja2</a></li>
								<li><a href="#">You can modify those links in your config file</a></li>
							</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
								<li><a href="#">You can add links in your config file</a></li>
								<li><a href="#">Another social link</a></li>
							</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
			<div class="page-header"><h1> Lyon's Blog </h1></div>			
<div class='article'>
	<h2>TODO</h2>
	<div class="well small">Permalink: <a class="more" href="./todo.html">2013-08-21 20:45:46</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/misc.html">misc</a>
</div>
	<div class="summary"><h2>2013-05-08</h2>
<h3>TODO TODAY</h3>
<ul>
<li>
<p>蕃茄工作法做笔记（思维导图）</p>
</li>
<li>
<p>总结peclian</p>
</li>
</ul>
<p>mysql replication, mysql 索引树</p> <a class="btn primary xsmall" href="./todo.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Problems I encouter with emacs</h2>
	<div class="well small">Permalink: <a class="more" href="./problems-i-encouter-with-emacs.html">2013-08-20 18:06:34</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/emacs.html">emacs</a>
</div>
	<div class="summary"><p>emacs with zsh</p>
<p>when I first open zsh in emacs using:</p>
<div class="highlight"><pre><span class="n">M</span><span class="o">-</span><span class="n">x</span> <span class="n">term</span>
</pre></div>


<p>It always print strange characters like "4m", that's because I don't have eterm-color terminfo,
I solve this problem by running:</p>
<div class="highlight"><pre><span class="cp"># If you use Cocoa Emacs or Carbon Emacs</span>
<span class="n">tic</span> <span class="o">-</span><span class="n">o</span> <span class="o">~/</span><span class="p">.</span><span class="n">terminfo</span> <span class="o">/</span><span class="n">Applications</span><span class="o">/</span><span class="n">Emacs</span><span class="p">.</span><span class="n">app ...</span></pre></div> <a class="btn primary xsmall" href="./problems-i-encouter-with-emacs.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>The python packages I love</h2>
	<div class="well small">Permalink: <a class="more" href="./the-python-packages-i-love.html">2013-08-12 13:26:18</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/python.html">python</a>
</div>
	<div class="summary"><p>gevent:</p>
<p>arrow: Better dates &amp; times for Python https://github.com/crsmithdev/arrow http://crsmithdev.com/arrow</p>
<p>requests: </p>
<p>grequests:</p>
<p>undead: https://github.com/waawal/undead</p>
<p>legit
envoy
tablib
clint
autoenv</p> <a class="btn primary xsmall" href="./the-python-packages-i-love.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>urwid</h2>
	<div class="well small">Permalink: <a class="more" href="./urwid.html">2013-08-09 16:21:44</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/python.html">python</a>
</div>
	<div class="summary"><p>最近要写一个mongo current op的管理工具，</p>
<p>http://www.nicosphere.net/urwid-for-python-a-ncurses-library-2541/</p>
<p>https://github.com/intnull/videotop/blob/master/videotop.py</p>
<p>Why can't I select text in an Urwid program?</p>
<p>By default Urwid's MainLoop tells the terminal that it will handle mouse input so it can react to things like selecting widgets ...</p> <a class="btn primary xsmall" href="./urwid.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>Find out which process open a linux port</h2>
	<div class="well small">Permalink: <a class="more" href="./find-out-which-process-open-a-linux-port.html">2013-08-09 15:48:46</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/linux.html">linux</a>
</div>
	<div class="summary"><p>最近在调mongodb的性能，发现currentop中有很多长时间运行的查询，从currentop中可以看到查询来源ip:port。</p>
<p>那么可以到ip机器上查询port对应的进程号，进而找到发出此查询的应用。</p>
<p>根据port来查询进程号有多种方案：</p>
<ol>
<li>
<p>netstat， <code>sudo netstat -anp | grep &lt;port&gt;</code></p>
<p>关于netstat的使用参考：http://www.thegeekstuff.com/2010/03/netstat-command-examples/</p>
</li>
<li>
<p>fuser，找到使用tcp 7000端口号的进程：<code>sudo fuser 7000/tcp</code></p>
</li>
<li>
<p>lsof</p>
<div class="highlight"><pre><span class="n">lsof</span> <span class="o">-</span><span class="n">i</span> <span class="o">:</span><span class="n">portNumber</span>
<span class="n">lsof</span> <span class="o">-</span><span class="n">i</span> <span class="n">tcp</span><span class="o">:</span><span class="n">portNumber</span>
<span class="n">lsof</span> <span class="o">-</span><span class="n">i</span> <span class="n">udp</span><span class="o">:</span><span class="n">portNumber</span>
<span class="n">lsof</span> <span class="o">-</span><span class="n">i</span> <span class="o">:</span><span class="mi">80</span>
</pre></div>


</li>
</ol>
<p>通过这几种方式找到进程号后，可以利用<code>ps -eaf | grep &lt;pid&gt;</code>找到此进程的执行命令 ...</p> <a class="btn primary xsmall" href="./find-out-which-process-open-a-linux-port.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>locale</h2>
	<div class="well small">Permalink: <a class="more" href="./locale.html">2013-08-08 13:45:42</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/linux.html">linux</a>
</div>
	<div class="summary"><p>当在终端下执行某些操作，提示编码问题时，基本是因为终端的locale环境的编码不支持。</p>
<p>有些终端下默认的LC_*设置为<code>C</code>，可运行<code>locale</code>查看，也可查看<code>/etc/default/locale</code>，
此时终端环境的默认编码是<code>ASCII</code>。</p>
<p>可将其改为<code>UTF8</code>编码。</p>
<p>修改方式如下：</p>
<ol>
<li>用<code>locale -a</code>命令查看系统支持的category。</li>
<li>在终端下进行<code>export LANG=&lt;category&gt;</code>，此时终端的<code>LC_*</code>变量发生了变化。
    如果不想每次手动设置，可将<code>export LANG=&lt;category&gt;</code>加到<code>.bashrc</code>中。</li>
</ol> <a class="btn primary xsmall" href="./locale.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>PuDB</h2>
	<div class="well small">Permalink: <a class="more" href="./pudb.html">2013-08-06 10:31:12</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/python.html">python</a>
</div>
	<div class="summary"><p>https://pypi.python.org/pypi/pudb</p> <a class="btn primary xsmall" href="./pudb.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>transfer munin server</h2>
	<div class="well small">Permalink: <a class="more" href="./transfer-munin-server.html">2013-08-05 13:27:23</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/munin.html">munin</a>
</div>
	<div class="summary"><p>当修改某一node的主机名时，修改后此node的所有历史记录都会消失，可以恢复这些历史数据，在munin中所有数据都保存在rrd文件中，此文件在/var/lib/munin中，如：social/services.social-uptime-uptime-g.rrd 是主机名为services.social的其中一个数据文件。当修改了node的主机名时，只需要同时对数据文件重命名即可。</p>
<ol>
<li>取消munin crontab的执行， cd /etc/cron.d/; sudo mv munin munin.disable
    crontab不会执行/etc/cron.d/下文件名中带有“.”的文件</li>
<li>生命名数据文件</li>
<li>修改munin配置/etc/munin/munin.conf中的node主机名</li>
<li>修改munin crontab执行，5分钟后将会看到更新的结果。</li>
</ol>
<p><strong>NOTE</strong>： 改动数据文件前要先取消crontab的执行，否则可能会影响历史数据, 同时数据文件迁移之后，要保证用户munin有对这些rrd文件写的权限。因为用<code>sudo ...</code></p> <a class="btn primary xsmall" href="./transfer-munin-server.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>munin</h2>
	<div class="well small">Permalink: <a class="more" href="./munin.html">2013-08-05 13:17:46</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/munin.html">munin</a>
</div>
	<div class="summary"><h2>Writing plugins</h2>
<p>global attribute: http://munin-monitoring.org/wiki/protocol-config</p>
<p>redis munin 有改动，总是说Redis找不到，一会儿一下问题，做一个patch</p>
<p>mulitgraph: http://munin-monitoring.org/wiki/protocol-multigraph</p>
<h2>fw_conntract fw_forwarded_local timeout</h2>
<p>配置好munin之后，fw_conntrack总是报警，读不到数据，主要原因是执行fw_conntrack超时，munin plugin的默认超时时间是10s，超时主要是因为<code>cat /proc/net/ip_conntrack</code>，对于网络请求少的服务器，此语句会很快执行完，但对于网络请求比较多的服务器，此语句耗时可能要超过30s。</p>
<p>Google的相应问题，此问题早已被人解决，解决方案见如下链接：
http://bugs.debian.org/cgi-bin/bugreport.cgi?bug ...</p> <a class="btn primary xsmall" href="./munin.html">more…</a>
	</div>
</div>	
<div class='article'>
	<h2>fabric</h2>
	<div class="well small">Permalink: <a class="more" href="./fabric.html">2013-07-31 11:19:32</a>
by <a class="url fn" href="./author/zhang-liyong.html">zhang liyong </a>
 in <a href="./category/python.html">python</a>
</div>
	<div class="summary"><p>下面介绍python下的一个用于项目部署的工具<a href="http://docs.fabfile.org/">fabric</a>，要学习fabric推荐阅读其官方文档，</p>
<p>本文给只给出一个简单的介绍及一些基本的功能。</p>
<p>根据官方文档的介绍:</p>
<blockquote>
<p>Fabric is:</p>
<p>A tool that lets you execute arbitrary Python functions via the command line;
A library of subroutines (built on top of a lower-level library) to make executing shell commands over SSH easy and Pythonic.</p>
</blockquote>
<p>首先安装fabric <code>pip install fabric</code>，安装完fabric之后，系统会多出fab命令。</p>
<p>fab命令在执行时会读取当前目录下的fabfile.py文件，并根据fabric的参数来执行文件中的函数 ...</p> <a class="btn primary xsmall" href="./fabric.html">more…</a>
	</div>
</div>	

<div class="pagination">
<ul>
			<li class="prev disabled"><a href="#">&larr; Previous</a></li>
				<li class="active"><a href="./index.html">1</a></li>
			<li class=""><a href="./index2.html">2</a></li>
			<li class=""><a href="./index3.html">3</a></li>
			<li class=""><a href="./index4.html">4</a></li>
			<li class=""><a href="./index5.html">5</a></li>
				<li class="next"><a href="./index2.html">Next &rarr;</a></li>
	</ul>
</div>

		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; zhang liyong</p>
		</footer>
	  </div>

	</div>
</body>
</html>